

CREATE TABLE INVOICE(
INVOICE_ID NUMBER(5) PRIMARY KEY,
DATEOFPURCHASE DATE,
AMOUNT NUMBER(5,2),
CUSTOMER_ID NUMBER(5)
);

CREATE TABLE CUSTOMER(
CUSTOMER_ID NUMBER(5) PRIMARY KEY ,
FIRST_NAME VARCHAR2(50),
LAST_NAME VARCHAR2(50),
EMAIL VARCHAR2(50)
);

ALTER TABLE INVOICE
MODIFY CUSTOMER_ID REFERENCES CUSTOMER;


INSERT INTO CUSTOMER VALUES (1001,'JOHN', 'SMITH', 'JOHNSMITH@YAHOO.COM');
INSERT INTO CUSTOMER VALUES (1002,'JAMES', 'ROGAN',  'JAMESROGAN@AOL.COM');
INSERT INTO CUSTOMER VALUES (1003,'DAVID', 'GETA',  'DAVID-GETA@HOTMAIL.COM');
INSERT INTO CUSTOMER VALUES (1004,'EDWARD', 'LAWRENCE',  'EDWARD_LAWRANCE@AOL.COM');
INSERT INTO CUSTOMER VALUES (1005,'JACKSON', 'NEIL',  'JACKSONNEIL@MSN.COM');


INSERT INTO INVOICE VALUES (11, DATE '2018-09-23', 878.89,1001);
INSERT INTO INVOICE VALUES (12, DATE '2019-07-04', 45.99,1002);
INSERT INTO INVOICE VALUES (13, DATE '2018-05-09', 345.89,1003);
INSERT INTO INVOICE VALUES (14, DATE '2018-12-14', 233.89,1004);
INSERT INTO INVOICE VALUES (15, DATE '2017-11-12', 235.89,1005);
INSERT INTO INVOICE VALUES (16, DATE '2019-02-13', 569.89,1003);
INSERT INTO INVOICE VALUES (17, DATE '2018-07-17', 987.89,1004);
INSERT INTO INVOICE VALUES (18, DATE '2018-09-23', 90.89,1002);
INSERT INTO INVOICE VALUES (19, DATE '2019-02-28', 235.89,1005);
INSERT INTO INVOICE VALUES (20, DATE '2018-09-29', 256.89,1001);

UPDATE CUSTOMER
SET FIRST_NAME = 'CAPLAN', EMAIL= 'CAPLAN_ROGAN@AOL.COM'
WHERE CUSTOMER_ID = 1002;

UPDATE INVOICE
SET DATEOFPURCHASE =DATE '2019-02-26'
WHERE INVOICE_ID = 1;


UPDATE INVOICE
SET DATEOFPURCHASE =DATE '2019-02-26'
WHERE INVOICE_ID = 14;

DELETE FROM INVOICE WHERE INVOICE_ID= 12;
DELETE FROM INVOICE WHERE INVOICE_ID= 19;
DELETE FROM INVOICE WHERE INVOICE_ID= 16;
DELETE FROM INVOICE WHERE INVOICE_ID= 13;

SELECT * FROM INVOICE WHERE DATEOFPURCHASE =DATE '2019-02-26'

SELECT CUSTOMER.CUSTOMER_ID, CUSTOMER.FIRST_NAME, CUSTOMER.LAST_NAME,INVOICE.DATEOFPURCHASE,INVOICE.AMOUNT
FROM CUSTOMER
INNER JOIN INVOICE ON INVOICE.CUSTOMER_ID=CUSTOMER.CUSTOMER_ID ORDER BY CUSTOMER.CUSTOMER_ID;


SELECT COUNT (INVOICE_ID)
FROM INVOICE
GROUP BY(CUSTOMER_ID);

SELECT SUM (AMOUNT)
FROM INVOICE
GROUP BY(CUSTOMER_ID);

SELECT *
FROM INVOICE WHERE DATEOFPURCHASE > DATE '2019-02-01'
ORDER BY DATEOFPURCHASE DESC;

SELECT AMOUNT
FROM INVOICE
ORDER BY AMOUNT DESC
FETCH FIRST 3 ROWS ONLY;